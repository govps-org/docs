(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{314:function(t,e,s){"use strict";s.r(e);var a=s(14),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"deployments"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deployments"}},[t._v("#")]),t._v(" Deployments")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#overview"}},[t._v("Overview")])]),e("li",[e("a",{attrs:{href:"#environments"}},[t._v("Environments")]),e("ul",[e("li",[e("a",{attrs:{href:"#environment-circle-permission"}},[t._v("Environment Circle Permission")])]),e("li",[e("a",{attrs:{href:"#encrypted-environment-files"}},[t._v("Encrypted Environment Files")])])])]),e("li",[e("a",{attrs:{href:"#quick-deploy"}},[t._v("Quick Deploy")])]),e("li",[e("a",{attrs:{href:"#deploy-script"}},[t._v("Deploy Script")]),e("ul",[e("li",[e("a",{attrs:{href:"#php-versions"}},[t._v("PHP Versions")])]),e("li",[e("a",{attrs:{href:"#environment-variables"}},[t._v("Environment Variables")])])])]),e("li",[e("a",{attrs:{href:"#deploying-from-ci"}},[t._v("Deploying From CI")]),e("ul",[e("li",[e("a",{attrs:{href:"#using-deployment-triggers"}},[t._v("Using Deployment Triggers")])]),e("li",[e("a",{attrs:{href:"#using-govps-cli"}},[t._v("Using GoVPS CLI")])])])]),e("li",[e("a",{attrs:{href:"#deployment-branch"}},[t._v("Deployment Branch")])]),e("li",[e("a",{attrs:{href:"#git-remote"}},[t._v("Git Remote")])]),e("li",[e("a",{attrs:{href:"#deployment-notifications"}},[t._v("Deployment Notifications")]),e("ul",[e("li",[e("a",{attrs:{href:"#slack"}},[t._v("Slack")])]),e("li",[e("a",{attrs:{href:"#telegram"}},[t._v("Telegram")])]),e("li",[e("a",{attrs:{href:"#microsoft-teams"}},[t._v("Microsoft Teams")])]),e("li",[e("a",{attrs:{href:"#discord"}},[t._v("Discord")])]),e("li",[e("a",{attrs:{href:"#webhooks"}},[t._v("Webhooks")])])])]),e("li",[e("a",{attrs:{href:"#circle-permissions"}},[t._v("Circle Permissions")])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"overview"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),e("p",[t._v("A deployment is the process in which your code is downloaded from your source control provider on to your server, ready for the world to access. GoVPS tracks the latest 10 deployments so that you can see what was deployed, when it was deployed, how long it took to be deployed, and also view the output of your "),e("RouterLink",{attrs:{to:"/1.0/sites/deployments.html#deploy-script"}},[t._v("deploy script")]),t._v(".")],1),t._v(" "),e("h2",{attrs:{id:"environments"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#environments"}},[t._v("#")]),t._v(" Environments")]),t._v(" "),e("p",[t._v("Some applications, such as those created with the Laravel framework, may require a "),e("code",[t._v(".env")]),t._v(" file to configure settings such as databases and caches. You can create and edit your Environment file within the GoVPS site's management dashboard.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Automatic Environment Files")]),t._v(" "),e("p",[t._v("If your project contains a "),e("code",[t._v(".env.example")]),t._v(" file, GoVPS will automatically copy this and replace some of the settings to match your server's database settings. An empty "),e("code",[t._v(".env.example")]),t._v(" could result in an empty environment file on the first deploy.")])]),t._v(" "),e("h3",{attrs:{id:"environment-circle-permission"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#environment-circle-permission"}},[t._v("#")]),t._v(" Environment Circle Permission")]),t._v(" "),e("p",[t._v("You may grant a circle member authority to view and edit a site's environment file (or WordPress configuration) using the "),e("code",[t._v("site:manage-environment")]),t._v(" permission. Without this permission, GoVPS will "),e("strong",[t._v("not")]),t._v(" display the contents of the environment file to circle members.")]),t._v(" "),e("h3",{attrs:{id:"encrypted-environment-files"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#encrypted-environment-files"}},[t._v("#")]),t._v(" Encrypted Environment Files")]),t._v(" "),e("p",[t._v("GoVPS provides support for Laravel's "),e("a",{attrs:{href:"https://laravel.com/docs/configuration#encrypting-environment-files",target:"_self",rel:"false"}},[t._v("encrypted environment files")]),t._v(" without requiring you to include your encryption key within your deployment script.")]),t._v(" "),e("p",[t._v('To leverage this feature, add your encryption key to the "Environment Encryption Key" section of your site\'s management dashboard. Once added, GoVPS will inject the value into the '),e("code",[t._v("LARAVEL_ENV_ENCRYPTION_KEY")]),t._v(" environment variable during deployment, allowing you to add the "),e("code",[t._v("env:decrypt")]),t._v(" Artisan command to your deployment script without explicitly setting the "),e("code",[t._v("--key")]),t._v(" option:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("php artisan env:decrypt --force\n")])])]),e("h2",{attrs:{id:"quick-deploy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quick-deploy"}},[t._v("#")]),t._v(" Quick Deploy")]),t._v(" "),e("p",[t._v("GoVPS's \"Quick Deploy\" feature allows you to easily deploy your projects when you push to your source control provider. When you push to your configured quick deploy branch, GoVPS will pull your latest code from source control and run your application's configured deployment script.")]),t._v(" "),e("p",[t._v('You can enable GoVPS\'s quick deploy feature by clicking the "Enable Quick Deploy" button within the '),e("em",[t._v("Apps")]),t._v(" tab of your site's management dashboard.")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Custom Git Providers")]),t._v(" "),e("p",[t._v("GoVPS's quick deploy feature is not available to sites set up with a "),e("RouterLink",{attrs:{to:"/1.0/accounts/source-control.html#using-a-custom-git-provider"}},[t._v("custom source control provider")]),t._v(". Instead, you may set up a "),e("RouterLink",{attrs:{to:"/1.0/sites/deployments.html#deploying-from-ci"}},[t._v("Deployment Trigger")]),t._v(" to have your code deployed when you push to your source provider.")],1)]),t._v(" "),e("h2",{attrs:{id:"deploy-script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploy-script"}},[t._v("#")]),t._v(" Deploy Script")]),t._v(" "),e("p",[t._v("The commands that are executed on your server when your project is deployed are determined by your site's deployment script. Of course, this deployment script can be edited directly within the GoVPS UI. By default, your site's deployment script will:")]),t._v(" "),e("ul",[e("li",[t._v("Navigate into the site's directory")]),t._v(" "),e("li",[t._v("Execute the "),e("code",[t._v("git pull")]),t._v(" command")]),t._v(" "),e("li",[t._v("Installs your application's Composer dependencies")]),t._v(" "),e("li",[t._v("Execute the "),e("code",[t._v("php artisan migrate")]),t._v(" command (if your application contains an "),e("code",[t._v("artisan")]),t._v(" file)")])]),t._v(" "),e("p",[t._v("You can make your "),e("code",[t._v(".env")]),t._v(' variables available to your deploy script by checking the "Make .env variables to deploy script" checkbox below the Deploy Script panel. When enabled, GoVPS will automatically inject the variables in your site\'s '),e("code",[t._v(".env")]),t._v(" file into the deploy script, allowing them to be accessed like any normal Bash variable:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${APP_NAME}")]),t._v(' is deploying..."')]),t._v("\n")])])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Zero Downtime Deployments")]),t._v(" "),e("p",[t._v("Deployments may make your site unavailable for a brief moment. If you need absolutely zero downtime during deployments, check out "),e("a",{attrs:{href:"https://envoyer.io",target:"_self",rel:"false"}},[t._v("Envoyer")]),t._v(".")])]),t._v(" "),e("h3",{attrs:{id:"php-versions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php-versions"}},[t._v("#")]),t._v(" PHP Versions")]),t._v(" "),e("p",[t._v("If you have installed "),e("RouterLink",{attrs:{to:"/1.0/servers/php.html"}},[t._v("multiple versions of PHP")]),t._v(" on your server, your deploy script may need to be updated to use the correct version of PHP.")],1),t._v(" "),e("p",[t._v("By default, "),e("code",[t._v("php")]),t._v(" will always point to the active version of PHP used on the CLI. If you need to use a different version of PHP, you must use "),e("code",[t._v("phpx.x")]),t._v(" where "),e("code",[t._v("x.x")]),t._v(" reflects on the version used (e.g. "),e("code",[t._v("php8.1")]),t._v(") when invoking PHP commands.")]),t._v(" "),e("p",[t._v("The deploy script for newly created sites uses the "),e("code",[t._v("$FORGE_PHP")]),t._v(" "),e("a",{attrs:{href:"#environment-variables"}},[t._v("environment variable")]),t._v(". This environment variable will always contain the current PHP binary configured for the site, so no additional changes are needed to your deployment script when using this variable and switching your site's PHP version.")]),t._v(" "),e("h3",{attrs:{id:"environment-variables"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#environment-variables"}},[t._v("#")]),t._v(" Environment Variables")]),t._v(" "),e("p",[t._v("GoVPS will automatically inject the following environment variables into your deployment script at runtime:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Key")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("FORGE_COMPOSER")])]),t._v(" "),e("td",[t._v("The path to the Composer installation.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_CUSTOM_DEPLOY")])]),t._v(" "),e("td",[t._v("Whether the deployment was triggered with a custom deployment trigger request.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_DEPLOY_AUTHOR")])]),t._v(" "),e("td",[t._v("The author of the commit.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_DEPLOY_COMMIT")])]),t._v(" "),e("td",[t._v("The Git hash of the commit being deployed.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_DEPLOY_MESSAGE")])]),t._v(" "),e("td",[t._v("The Git commit message.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_MANUAL_DEPLOY")])]),t._v(" "),e("td",[t._v('Whether the deploy was triggered by clicking "Deploy Now".')])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_PHP_FPM")])]),t._v(" "),e("td",[t._v("The PHP-FPM process name that is being used by GoVPS.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_PHP")])]),t._v(" "),e("td",[t._v("The "),e("code",[t._v("php")]),t._v(" binary that is being used by the GoVPS site or server.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_QUICK_DEPLOY")])]),t._v(" "),e("td",[t._v("Whether the deploy was triggered by a source control provider webhook.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_REDEPLOY")])]),t._v(" "),e("td",[t._v("Whether this is a re-deployed commit.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_SERVER_ID")])]),t._v(" "),e("td",[t._v("The ID of the GoVPS server that is being deployed to.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_SITE_BRANCH")])]),t._v(" "),e("td",[t._v("The name of the branch that is being deployed.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_SITE_ID")])]),t._v(" "),e("td",[t._v("The ID of the GoVPS site that is being deployed to.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_SITE_PATH")])]),t._v(" "),e("td",[t._v("The root of the deployment path, e.g. "),e("code",[t._v("/home/forge/mysite.com")])])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("FORGE_SITE_USER")])]),t._v(" "),e("td",[t._v("The name of the user deploying the site.")])])])]),t._v(" "),e("p",[t._v("You may use these variables as you would any other Bash variable:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$FORGE_MANUAL_DEPLOY")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-eq")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This deploy was triggered manually."')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n")])])]),e("p",[t._v('For example, you may wish to prevent deployments if the commit message contains "wip":')]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$FORGE_DEPLOY_MESSAGE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=~")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wip"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WORK IN PROGRESS, DO NOT CONTINUE."')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n")])])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Environment Variables")]),t._v(" "),e("p",[t._v("GoVPS will prefix any injected variables with "),e("code",[t._v("FORGE_")]),t._v('. Please do not use this "namespace" when defining your own environment variables.')])]),t._v(" "),e("h2",{attrs:{id:"deploying-from-ci"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploying-from-ci"}},[t._v("#")]),t._v(" Deploying From CI")]),t._v(" "),e("p",[t._v('So far, we have discussed deploying GoVPS sites from the GoVPS UI or by using GoVPS\'s "Quick Deploy" feature. However, you may also deploy them from a CI platform of your choice.')]),t._v(" "),e("p",[t._v("To execute a GoVPS deployment from a CI platform, you may use Deployment Triggers or GoVPS CLI.")]),t._v(" "),e("h3",{attrs:{id:"using-deployment-triggers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-deployment-triggers"}},[t._v("#")]),t._v(" Using Deployment Triggers")]),t._v(" "),e("p",[t._v("You may execute a deployment at any time by instructing your CI platform to make a "),e("code",[t._v("GET")]),t._v(" or "),e("code",[t._v("POST")]),t._v(" request to the "),e("strong",[t._v('"Deployment Trigger URL"')]),t._v(" displayed in your site's details.")]),t._v(" "),e("p",[t._v("Although you can refresh the site token at any time, you will need to update any services which are using this URL after refreshing the token.")]),t._v(" "),e("p",[t._v("Additional data may be passed to your deployment script via query parameters passed to the deployment trigger URL. For example, when passing the following query parameters "),e("code",[t._v("?token=abc1234&env=staging")]),t._v(", GoVPS will automatically inject a custom "),e("code",[t._v("FORGE_VAR_ENV")]),t._v(" variable that will evaluate to "),e("code",[t._v('"staging"')]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"using-govps-cli"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-govps-cli"}},[t._v("#")]),t._v(" Using GoVPS CLI")]),t._v(" "),e("p",[t._v("If you would like to have access to the deployment output or execute additional deployment actions such as restarting services, you may use "),e("RouterLink",{attrs:{to:"/1.0/cli.html"}},[t._v("GoVPS CLI")]),t._v(".")],1),t._v(" "),e("p",[t._v("Once you have installed GoVPS CLI, you may execute the "),e("code",[t._v("forge deploy")]),t._v(" command in your CI platform's deployment pipeline.")]),t._v(" "),e("p",[t._v("In order to authenticate with GoVPS from your CI platform, you will need to add a "),e("code",[t._v("FORGE_API_TOKEN")]),t._v(" environment variable to your CI build environment. You may generate an API token in your "),e("a",{attrs:{href:"https://govps.org/user-profile/api",target:"_self",rel:"false"}},[t._v("GoVPS API settings dashboard")]),t._v(". In addition, your CI platform will need SSH Access to your server.")]),t._v(" "),e("h4",{attrs:{id:"example-with-github-actions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-with-github-actions"}},[t._v("#")]),t._v(" Example With GitHub Actions")]),t._v(" "),e("p",[t._v("If your site uses "),e("a",{attrs:{href:"https://github.com/features/actions",target:"_self",rel:"false"}},[t._v("GitHub Actions")]),t._v(" as its CI platform, the following guidelines will assist you in configuring GoVPS deployments so that your application is automatically deployed when someone pushes a commit to the "),e("code",[t._v("main")]),t._v(" branch:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("First, add the "),e("code",[t._v("FORGE_API_TOKEN")]),t._v(' environment variable to your "GitHub > Project Settings > Secrets" settings so that GitHub can authenticate with GoVPS while running actions.')])]),t._v(" "),e("li",[e("p",[t._v("Next, add the "),e("code",[t._v("SSH_PRIVATE_KEY")]),t._v(' environment variable to your "GitHub > Project Settings > Secrets" settings so that GitHub can have SSH Access to your site\'s server.')])]),t._v(" "),e("li",[e("p",[t._v("Then, create a "),e("code",[t._v("deploy.yml")]),t._v(" file within the "),e("code",[t._v("your-project/.github/workflows")]),t._v(" directory. The file should have the following contents:")])])]),t._v(" "),e("div",{staticClass:"language-yml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" main "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploy")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout code\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v3\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup SSH\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" webfactory/ssh"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("agent@v0.7.0\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssh-private-key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.SSH_PRIVATE_KEY "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup PHP\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" shivammathur/setup"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php@v2\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("php-version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.1")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tools")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" composer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("v2\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("coverage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Require GoVPS CLI\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" composer global require laravel/forge"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cli\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy Site\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v("\n          forge server:switch your-server-name\n          forge deploy your-site-name.com")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("FORGE_API_TOKEN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.FORGE_API_TOKEN "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("ol",{attrs:{start:"4"}},[e("li",[t._v("Finally, you can edit the "),e("code",[t._v("deploy.yml")]),t._v(" file to fit your site's deployment needs, as it may require a different PHP version or a library like "),e("code",[t._v("npm")]),t._v(". Once you are done, commit and push the "),e("code",[t._v("deploy.yml")]),t._v(" file to the "),e("code",[t._v("main")]),t._v(" branch so GitHub Actions can run the first deployment job.")])]),t._v(" "),e("h4",{attrs:{id:"example-with-chipper-ci"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-with-chipper-ci"}},[t._v("#")]),t._v(" Example With Chipper CI")]),t._v(" "),e("p",[t._v("If your site uses "),e("a",{attrs:{href:"https://chipperci.com",target:"_self",rel:"false"}},[t._v("Chipper CI")]),t._v(" as its CI platform, the following configuring can be used to deploy your GoVPS sites when pushing to the "),e("code",[t._v("main")]),t._v(" branch:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("First, add the "),e("code",[t._v("FORGE_API_TOKEN")]),t._v(' environment variable to your "Project > Project Settings > Secrets" settings so that Chipper can authenticate with GoVPS.')])]),t._v(" "),e("li",[e("p",[t._v("Next, add the "),e("code",[t._v("SSH_PRIVATE_KEY")]),t._v(' environment variable to your "Project > Project Settings > Secrets" settings so that Chipper has SSH access to your site\'s server.')])]),t._v(" "),e("li",[e("p",[t._v("Then, edit your "),e("code",[t._v(".chipperci.yml")]),t._v(" file. The file will look something like this:")])])]),t._v(" "),e("div",{staticClass:"language-yml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("php")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.1")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" main\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add the following 2 pipeline steps to your Chipper CI pipeline:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pipeline")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Configure GoVPS\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cmd")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v("\n      echo $SSH_PRIVATE_KEY > ~/.ssh/id_forge\n      chmod 0600 ~/.ssh/id_forge\n      composer global require laravel/forge-cli")]),t._v("\n    \n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cmd")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v("\n      forge server:switch your-server-name\n      forge deploy your-site-name.com")]),t._v("\n")])])]),e("ol",{attrs:{start:"4"}},[e("li",[t._v("Of course, you can adjust the "),e("code",[t._v(".chipperci.yml")]),t._v(" file further to fit your needs. Once you are done, commit and push to the "),e("code",[t._v("main")]),t._v(" branch so Chipper CI can deploy your site.")])]),t._v(" "),e("h2",{attrs:{id:"deployment-branch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deployment-branch"}},[t._v("#")]),t._v(" Deployment Branch")]),t._v(" "),e("p",[t._v("You may change the branch that is deployed to your site by updating the deployment branch setting. Once you have updated the branch, you will then need to click "),e("strong",[t._v("Deploy Now")]),t._v(" to manually trigger a fresh deployment of the new branch.")]),t._v(" "),e("h2",{attrs:{id:"git-remote"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#git-remote"}},[t._v("#")]),t._v(" Git Remote")]),t._v(" "),e("p",[t._v("Updating the Git remote from the site's "),e("strong",[t._v("App")]),t._v(" management dashboard will update the Git remote URL on your server; however, the site will not be removed or become unavailable during the process. The updated Git remote must contain the same repository / Git history as the currently installed repository.")]),t._v(" "),e("p",[t._v('You should not use this function to install an entirely different project onto a site. If you would like to install an entirely different project, you should completely uninstall the existing repository using the "Uninstall Repository" button within the '),e("strong",[t._v("App")]),t._v(" dashboard.")]),t._v(" "),e("h2",{attrs:{id:"deployment-notifications"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deployment-notifications"}},[t._v("#")]),t._v(" Deployment Notifications")]),t._v(" "),e("p",[t._v("You can enable deployment notifications for your site from the site management dashboard's "),e("strong",[t._v("Notifications")]),t._v(" tab. GoVPS supports several notification channels:")]),t._v(" "),e("ul",[e("li",[t._v("Email")]),t._v(" "),e("li",[t._v("Slack")]),t._v(" "),e("li",[t._v("Telegram")]),t._v(" "),e("li",[t._v("Microsoft Teams")]),t._v(" "),e("li",[t._v("Discord")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Default Notifications For Failed Deployments")]),t._v(" "),e("p",[t._v("By default, GoVPS will automatically notify you by email for failed deployments.")])]),t._v(" "),e("h3",{attrs:{id:"slack"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#slack"}},[t._v("#")]),t._v(" Slack")]),t._v(" "),e("p",[t._v("To enable Slack notifications, first enter the Channel name that you wish to send messages to, and then click "),e("strong",[t._v("Enable Slack Notifications")]),t._v(". You will be redirected to the Slack application authorization page, where you need to click "),e("strong",[t._v("Allow")]),t._v(".")]),t._v(" "),e("p",[t._v("If you wish to modify the channel that GoVPS messages, you should first disable Slack notifications and then re-enable them for your site.")]),t._v(" "),e("h3",{attrs:{id:"telegram"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#telegram"}},[t._v("#")]),t._v(" Telegram")]),t._v(" "),e("p",[t._v("To enable Telegram notifications, click the "),e("strong",[t._v("Enable Telegram Notifications")]),t._v(" button. GoVPS will open a new window that takes you to the official Telegram website. If you have the desktop application installed, your browser will ask if you wish to open Telegram. Alternatively, you will need to login to the web version of Telegram.")]),t._v(" "),e("p",[t._v("Click "),e("strong",[t._v("Open Telegram")]),t._v(" and select the group chat that you want GoVPS to send deployment notifications to. GoVPS will send the group a message confirming the connection.")]),t._v(" "),e("p",[t._v("If you wish to change the group that GoVPS messages, you should disable Telegram notifications and then re-enable the notifications.")]),t._v(" "),e("h3",{attrs:{id:"microsoft-teams"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#microsoft-teams"}},[t._v("#")]),t._v(" Microsoft Teams")]),t._v(" "),e("p",[t._v("To enable Microsoft Teams notifications, you first need to create a new "),e("strong",[t._v("Incoming Webhook")]),t._v(" connector in your Teams channel of choice. Once Teams has generated a webhook, you need to copy the URL into the "),e("strong",[t._v("Webhook URL")]),t._v(" field, then click "),e("strong",[t._v("Enable Microsoft Teams Notifications")]),t._v(". GoVPS will now notify the configured channel for both successful and failed deployments.")]),t._v(" "),e("p",[t._v("If you wish to change the webhook URL, you first need to disable Microsoft Teams notifications and then re-enable the notifications.")]),t._v(" "),e("h3",{attrs:{id:"discord"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#discord"}},[t._v("#")]),t._v(" Discord")]),t._v(" "),e("p",[t._v("To enable Discord notifications, you first need to create a new "),e("strong",[t._v("Incoming Webhook")]),t._v(" integration on your Discord server. Once Discord has generated a webhook, you need to copy the URL into the "),e("strong",[t._v("Webhook URL")]),t._v(" field, then click "),e("strong",[t._v("Enable Discord Notifications")]),t._v(". GoVPS will now notify the configured channel for both successful and failed deployments.")]),t._v(" "),e("p",[t._v("If you wish to change the webhook URL, you first need to disable Discord notifications and then re-enable the notifications.")]),t._v(" "),e("h3",{attrs:{id:"webhooks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webhooks"}},[t._v("#")]),t._v(" Webhooks")]),t._v(" "),e("p",[t._v("GoVPS can also send an HTTP POST request to arbitrary URLs after each deployment. The payload of the request will contain the server ID, site ID, deployment status, and the relevant commit information:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"success"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"server"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-awesome-server"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"site"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("456")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-awesome-site.dev"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit_hash"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"382b0f5185773fa0f67a8ed8056c7759"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit_url"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://github.com/johndoe/my-awesome-site/commit/382b0f5185773fa0f67a8ed8056c7759"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit_author"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"John Doe"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit_message"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deploying!"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"circle-permissions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#circle-permissions"}},[t._v("#")]),t._v(" Circle Permissions")]),t._v(" "),e("p",[t._v("You may grant a circle member authority to manage deploy scripts, manage maintenance mode, and deploy a site by granting the "),e("code",[t._v("site:manage-deploys")]),t._v(" permission.")])])}),[],!1,null,null,null);e.default=n.exports}}]);